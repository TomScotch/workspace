(function(e,t,n){var r=qc.defineBehaviour("qc.engine.BtnEffect",qc.Behaviour,function(){},{});r.prototype.awake=function(){var e=this.gameObject.addScript("qc.TweenScale");e.from=new qc.Point(1,1),e.to=new qc.Point(.95,.95),e.duration=.1},r.prototype.onDown=function(){var e=this.gameObject.getScript("qc.TweenScale");e.playForward(!0)},r.prototype.onUp=function(){var e=this.gameObject.getScript("qc.TweenScale");e.playReverse(!0)};var i=qc.defineBehaviour("qc.engine.CreateUI",qc.Behaviour,function(){this.folder=""},{createBtn:qc.Serializer.NODE,browserBtn:qc.Serializer.NODE,path:qc.Serializer.NODE});i.prototype.awake=function(){var e=this;e.addListener(e.browserBtn.onClick,e.browser,e),e.addListener(e.createBtn.onClick,e.createProject,e)},i.prototype.browser=function(){var e=this;G.ProjectWizard.browser(function(t){e.path.text=t})},i.prototype.createProject=function(){var t=this.path.text;if(t===""){qc.Tween.resetGroupToBeginning(this.gameObject,1),qc.Tween.playGroupForward(this.gameObject,1);return}qc.editor.Operation.CREATE_PROJECT(t,function(n,r){n?qc.editor.Operation.OPEN_PROJECT(t,function(t){t?(G.storage.set("switchProject","1"),e.location.href="./index.html"):G.notification.error(G._("Open project failed."))}):G.notification.error(G._("Create project failed.")+" Reason:"+r)})};var s=qc.defineBehaviour("qc.engine.L",qc.Behaviour,function(){this.en=""},{en:qc.Serializer.STRING});s.prototype.awake=function(){e.G&&G.localize&&G.localize.language==="en"&&this.en!==""&&(this.gameObject.text=this.en)};var o=qc.defineBehaviour("qc.engine.Main",qc.Behaviour,function(){},{newProjectBtn:qc.Serializer.NODE,openProjectBtn:qc.Serializer.NODE,helpBtn:qc.Serializer.NODE,newProjectContent:qc.Serializer.NODE,openProjectContent:qc.Serializer.NODE,helpContent:qc.Serializer.NODE,tabSelectBackground:qc.Serializer.TEXTURE});o.prototype.awake=function(){var t=this;t.addListener(t.newProjectBtn.onClick,function(){t.switchTab(t.newProjectBtn)}),t.addListener(t.openProjectBtn.onClick,function(){t.switchTab(t.openProjectBtn)}),t.addListener(t.helpBtn.onClick,function(){t.switchTab(t.helpBtn)}),t.switchTab(t.helpBtn),e.G&&G.localize&&G.localize.language==="en"?document.getElementById("welcome").src="http://engine.qiciengine.com/welcome/welcome-en.html":document.getElementById("welcome").src="http://engine.zuoyouxi.com/welcome/welcome-zh.html"},o.prototype.switchTab=function(e){var t=this;if(e===t.currentTab)return;[t.newProjectContent,t.helpContent,t.openProjectContent].forEach(function(e){e.visible=!1}),[t.newProjectBtn,t.openProjectBtn,t.helpBtn].forEach(function(e){e.texture=null,e.text.color=new qc.Color(13290712)});if(t.currentUI){var n=t.currentUI;n.visible=!0;var r=t.currentUI.getScript(qc.TweenPosition);r.from=new qc.Point(0,0),r.to=new qc.Point(-t.game.width,0),r.playForward(!0),r.onFinished.addOnce(function(){n.visible=!1})}e===t.newProjectBtn?t._displayContent(e,t.newProjectContent):e===t.openProjectBtn?t._displayContent(e,t.openProjectContent):e===t.helpBtn&&t._displayContent(e,t.helpContent),t.currentTab=e},o.prototype._displayContent=function(e,t){var n=this.currentUI?!0:!1;this.currentUI=t,t.visible=!0,e.texture=this.tabSelectBackground,e.text.color=new qc.Color(16747854);if(n){var r=this.currentUI.getScript(qc.TweenPosition);r.from=new qc.Point(this.game.width,0),r.to=new qc.Point(0,0),r.playForward(!0)}};var u=qc.defineBehaviour("qc.engine.MinSize",qc.Behaviour,function(){this.minWidth=850,this.minHeight=470,this.runInEditor=!0},{minWidth:qc.Serializer.INT,minHeight:qc.Serializer.INT});u.prototype.awake=function(){var e=this;e.redraw(),e.addListener(e.game.world.onSizeChange,e.redraw,e)},u.prototype.redraw=function(){var e=1;this.game.width<this.minWidth&&(e=this.game.width/this.minWidth);if(this.game.height<this.minHeight){var t=this.game.height/this.minHeight;t<e&&(e=t)}this.gameObject.width=this.game.width/e,this.gameObject.height=this.game.height/e,this.gameObject.scaleX=e,this.gameObject.scaleY=e};var a=qc.defineBehaviour("qc.engine.OpenUI",qc.Behaviour,function(){this.folder=""},{openBtn:qc.Serializer.NODE,browserBtn:qc.Serializer.NODE,path:qc.Serializer.NODE});a.prototype.awake=function(){var e=this;e.addListener(e.browserBtn.onClick,e.browser,e),e.addListener(e.openBtn.onClick,e.openProject,e)},a.prototype.browser=function(){var e=this;G.ProjectWizard.browser(function(t){e.folder=t,e.path.text=t})},a.prototype.openProject=function(){var t=this.path.text;if(t==""){qc.Tween.resetGroupToBeginning(this.gameObject,1),qc.Tween.playGroupForward(this.gameObject,1);return}qc.editor.Operation.OPEN_PROJECT(t,function(t){t?(G.storage.set("switchProject","1"),e.location.href="./index.html"):G.notification.error(G._("Open project failed."))})};var f=qc.defineBehaviour("qc.engine.ProjectItem",qc.Behaviour,function(){this.index=0,this.recentUI=null},{title:qc.Serializer.NODE,path:qc.Serializer.NODE,flag:qc.Serializer.NODE});t.defineProperty(f.prototype,"selected",{get:function(){return this._selected},set:function(e){if(e===this._selected)return;this._selected=e,this.flag.visible=e,this.title.colorTint=e?new qc.Color(16777215):new qc.Color(13290712)}}),f.prototype.setData=function(e,t,n){this.index=t,this.recentUI=e,this.path.text=n;var r="";n.indexOf("/")!==-1?(r=n.substr(n.lastIndexOf("/")+1),r||(n=n.substr(0,n.length-1),r=n.substr(n.lastIndexOf("/")+1))):(r=n.substr(n.lastIndexOf("\\")+1),r||(n=n.substr(0,n.length-1),r=n.substr(n.lastIndexOf("\\")+1))),this.title.text=r},f.prototype.onClick=function(e){this.recentUI.current=this.index,(e.isDoubleClick||e.isDoubleTap)&&this.recentUI.getScript("qc.engine.OpenUI").openProject()};var l=qc.defineBehaviour("qc.engine.Recent",qc.Behaviour,function(){},{itemPrefab:qc.Serializer.PREFAB,root:qc.Serializer.NODE,path:qc.Serializer.NODE});t.defineProperty(l.prototype,"current",{get:function(){return this._current},set:function(e){if(e===this._current)return;this._current=e;var t=0;this.root.children.forEach(function(n){n.getScript("qc.engine.ProjectItem").selected=e===t,t++}),this.path.text=G.recentProjects[e]}}),l.prototype.awake=function(){var t=this,n=[];e.G||(e.G=[],G.recentProjects=["a/b","c/d","e/f"]),n=G.recentProjects;for(var r=0;r<n.length;r++){var i=t.game.add.clone(t.itemPrefab,t.root),s=i.getScript("qc.engine.ProjectItem");s.setData(t,r,n[r])}t.root.getScript("qc.TableLayout").relayout(),n.length>0&&(t.current=0)}}).call(this,this,Object)